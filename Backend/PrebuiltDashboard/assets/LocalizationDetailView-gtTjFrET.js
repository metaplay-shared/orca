import{d as M,bz as R,C as q,c5 as W,E as j,c as m,bH as G,bv as Q,h as J,r as f,e as u,o as n,w as t,j as e,f as l,m as S,q as _,k as s,_ as b,a as p,y as g,D as h,t as x,Q as K,T as X,bs as Y,bt as Z}from"./index-DAyiym1a.js";import{_ as tt}from"./LocalizationActionArchive.vue_vue_type_script_setup_true_lang-DC8Ziw16.js";import{_ as et}from"./LocalizationActionPublish.vue_vue_type_script_setup_true_lang-D3IATf-n.js";import{C as D}from"./CoreUiPlacement-Q0Nbc6Vr.js";import{a as at}from"./localization-DDIHoN6I.js";import{_ as it}from"./MTabLayout.vue_vue_type_script_setup_true_lang-xoFAviVR.js";import{_ as lt}from"./MRawDataCard.vue_vue_type_script_setup_true_lang-Q1r46_CP.js";import{_ as ot,a as st}from"./MViewContainer.vue_vue_type_script_setup_true_lang-DP4T6epC.js";import{_ as nt}from"./MActionModalButton.vue_vue_type_script_setup_true_lang-CRnsCPt_.js";import{_ as rt}from"./MInputText.vue_vue_type_script_setup_true_lang-B9sf9LSD.js";import{_ as ut}from"./MInputTextArea.vue_vue_type_script_setup_true_lang-Dxjs9C9J.js";import"./MInputCheckbox.vue_vue_type_script_setup_true_lang-CmGaUCkv.js";import"./MInputHintMessage.vue_vue_type_script_setup_true_lang-B7AbTbVm.js";import"./MActionModal.vue_vue_type_script_setup_true_lang-XDUxofmt.js";import"./index-CVSO09yM.js";import"./MInputSingleSelectDropdown.vue_vue_type_script_setup_true_lang-BRIBVSuX.js";import"./MSingleColumnLayout-CUJDqBPP.js";import"./debounce-CRuraxcR.js";import"./isSymbol-BXvDeGRF.js";const dt={class:"font-weight-bold"},vt={key:1,class:"text-muted tw-italic"},ct={key:2,class:"text-muted tw-italic"},ft={key:1,class:"text-muted tw-italic"},mt={class:"font-weight-bold"},_t={key:0},pt={key:1,class:"text-muted tw-italic"},bt={class:"font-weight-bold"},gt={class:"text-monospace small"},Pt=M({__name:"LocalizationDetailView",setup(ht){const I=Y(),L=R();q();const d=W(L.params.id),{data:B,refresh:E,error:$}=j(at()),i=m(()=>B.value?.find(r=>r.id===d)),N=m(()=>{if(!B.value?.find(r=>r.id===d))return new G("Localization Not Found",`The localization with the ID '${d}' does not exist. Are you looking in the right deployment?.`)});Q().setDynamicTitle(i,r=>`View ${r.value?.name??"Localization"}`);const w=m(()=>{const r=[];return i.value?.publishBlockingErrors.length&&r.push({title:"Build Cannot Be Published",message:"This build contains errors and cannot be published.",variant:"danger",dataTest:"cannot-publish-alert"}),i.value?.bestEffortStatus==="Building"&&r.push({title:"Config building...",message:"This localization is still building and has no content to view for now.",variant:"warning",dataTest:"building-alert"}),r}),T=m(()=>w.value.find(r=>r.variant==="danger")?"danger":w.value.find(r=>r.variant==="warning")?"warning":void 0),v=J({name:"",description:"",isArchived:!1});function V(){v.value={name:i.value?.name??"",description:i.value?.description??"",isArchived:i.value?.isArchived??!1}}const{showSuccessNotification:O}=Z();async function U(){const r={name:v.value.name,description:v.value.description,isArchived:v.value.isArchived};await I.post(`/localization/${d}`,r),O("Localization updated."),E()}const P=m(()=>i.value?.isActive?"Cannot diff this localization against itself.":i.value?.bestEffortStatus!=="Success"?"Cannot diff a localization that is not in a valid state.":void 0),F=[{label:"Details"},{label:"Audit Log"}],C=["Localizations/Details/Tab0","Localizations/Details/Tab1"];return(r,a)=>{const A=f("fa-icon"),o=f("b-td"),c=f("b-tr"),z=f("b-tbody"),k=f("b-table-simple"),H=f("meta-username");return n(),u(l(st),{variant:T.value,"is-loading":!i.value,error:l($)??N.value,"full-width":"",alerts:w.value,permission:"api.localization.view"},{overview:t(()=>[i.value?(n(),u(l(ot),{key:0,title:i.value.name||"No Name Available",subtitle:i.value.description,id:l(d),"data-testid":"localization-detail-overview-card"},{buttons:t(()=>[e(tt,{localizationId:l(d),"trigger-style":"button"},null,8,["localizationId"]),e(l(nt),{"modal-title":"Edit Localization Archive",action:U,"trigger-button-label":"Edit","ok-button-label":"Update",permission:"api.localization.edit",onShow:V,"data-testid":"edit-config"},{default:t(()=>[e(l(rt),{class:"tw-mb-2",label:"Name","model-value":v.value.name,variant:v.value.name.length>0?"success":"default",placeholder:"For example: 1.0.4 release candidate","onUpdate:modelValue":a[0]||(a[0]=y=>v.value.name=y)},null,8,["model-value","variant"]),e(l(ut),{label:"Description","model-value":v.value.description,variant:v.value.description.length>0?"success":"default",placeholder:"What is unique about this config build that will help you find it later?",rows:3,"onUpdate:modelValue":a[1]||(a[1]=y=>v.value.description=y)},null,8,["model-value","variant"])],void 0,!0),_:1}),e(l(X),{"disabled-tooltip":P.value,to:`diff?newRoot=${l(d)}`},{default:t(()=>a[19]||(a[19]=[s("Diff to Active",-1)]),void 0,!0),_:1,__:[19]},8,["disabled-tooltip","to"]),e(et,{localizationId:l(d),publishBlocked:i.value?.publishBlockingErrors.length>0},null,8,["localizationId","publishBlocked"])]),default:t(()=>[_("span",dt,[e(A,{icon:"chart-bar"}),a[2]||(a[2]=s(" Overview",-1))]),e(k,{small:"",responsive:""},{default:t(()=>[e(z,null,{default:t(()=>[e(c,null,{default:t(()=>[e(o,null,{default:t(()=>a[3]||(a[3]=[s("Status",-1)]),void 0,!0),_:1,__:[3]}),e(o,{class:"text-right"},{default:t(()=>[i.value.isArchived?(n(),u(l(b),{key:0,class:"tw-mr-1",variant:"neutral"},{default:t(()=>a[4]||(a[4]=[s("Archived",-1)]),void 0,!0),_:1,__:[4]})):S("",!0),i.value.isActive?(n(),u(l(b),{key:1,class:"tw-mr-1",variant:"success"},{default:t(()=>a[5]||(a[5]=[s("Active",-1)]),void 0,!0),_:1,__:[5]})):(n(),u(l(b),{key:2},{default:t(()=>a[6]||(a[6]=[s("Not active",-1)]),void 0,!0),_:1,__:[6]}))],void 0,!0),_:1})],void 0,!0),_:1}),e(c,null,{default:t(()=>[e(o,null,{default:t(()=>a[7]||(a[7]=[s("Last Published At",-1)]),void 0,!0),_:1,__:[7]}),e(o,{class:"text-right"},{default:t(()=>[i.value?.publishedAt?(n(),u(l(g),{key:0,instant:l(h).fromISO(i.value.publishedAt),showAs:"relativeSentenceCase"},null,8,["instant"])):i.value?.isActive?(n(),p("span",vt,"No time recorded")):(n(),p("span",ct,"Never"))],void 0,!0),_:1})],void 0,!0),_:1}),e(c,null,{default:t(()=>[e(o,null,{default:t(()=>a[8]||(a[8]=[s("Last Unpublished At",-1)]),void 0,!0),_:1,__:[8]}),e(o,{class:"text-right"},{default:t(()=>[i.value?.unpublishedAt?(n(),u(l(g),{key:0,instant:l(h).fromISO(i.value.unpublishedAt),showAs:"relativeSentenceCase"},null,8,["instant"])):(n(),p("span",ft,"Never"))],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1}),_("span",mt,[e(A,{icon:"chart-bar"}),a[9]||(a[9]=s(" Build Status",-1))]),e(k,{small:"",responsive:""},{default:t(()=>[e(z,null,{default:t(()=>[e(c,null,{default:t(()=>[e(o,null,{default:t(()=>a[10]||(a[10]=[s("Build Status",-1)]),void 0,!0),_:1,__:[10]}),e(o,{class:"text-right"},{default:t(()=>[_("div",null,x(i.value?.bestEffortStatus),1)],void 0,!0),_:1})],void 0,!0),_:1}),e(c,null,{default:t(()=>[e(o,null,{default:t(()=>a[11]||(a[11]=[s("Built By",-1)]),void 0,!0),_:1,__:[11]}),e(o,{class:"text-right"},{default:t(()=>[i.value.source==="disk"?(n(),u(l(b),{key:0},{default:t(()=>a[12]||(a[12]=[s("Built-in with the server",-1)]),void 0,!0),_:1,__:[12]})):(n(),u(H,{key:1,username:i.value.source},null,8,["username"]))],void 0,!0),_:1})],void 0,!0),_:1}),e(c,{class:K({"text-danger":i.value.publishBlockingErrors.length>0})},{default:t(()=>[e(o,null,{default:t(()=>a[13]||(a[13]=[s("Publish Blocking Errors",-1)]),void 0,!0),_:1,__:[13]}),e(o,{class:"text-right"},{default:t(()=>[i.value.publishBlockingErrors.length?(n(),p("span",_t,x(i.value.publishBlockingErrors.length),1)):(n(),p("span",pt,"None"))],void 0,!0),_:1})],void 0,!0),_:1},8,["class"])],void 0,!0),_:1})],void 0,!0),_:1}),_("span",bt,[e(A,{icon:"chart-bar"}),a[14]||(a[14]=s(" Technical Details",-1))]),e(k,{small:"",responsive:""},{default:t(()=>[e(z,null,{default:t(()=>[e(c,null,{default:t(()=>[e(o,null,{default:t(()=>a[15]||(a[15]=[s("Built At",-1)]),void 0,!0),_:1,__:[15]}),e(o,{class:"text-right"},{default:t(()=>[e(l(g),{instant:l(h).fromISO(i.value?.buildStartedAt),showAs:"relativeSentenceCase"},null,8,["instant"])],void 0,!0),_:1})],void 0,!0),_:1}),e(c,null,{default:t(()=>[e(o,null,{default:t(()=>a[16]||(a[16]=[s("Last Modified At",-1)]),void 0,!0),_:1,__:[16]}),e(o,{class:"text-right"},{default:t(()=>[i.value?(n(),u(l(g),{key:0,instant:l(h).fromISO(i.value?.lastModifiedAt),showAs:"relativeSentenceCase"},null,8,["instant"])):S("",!0)],void 0,!0),_:1})],void 0,!0),_:1}),e(c,null,{default:t(()=>[e(o,null,{default:t(()=>a[17]||(a[17]=[s("Version Hash",-1)]),void 0,!0),_:1,__:[17]}),i.value?(n(),u(o,{key:1,class:"text-right"},{default:t(()=>[_("div",gt,x(i.value.versionHash),1)],void 0,!0),_:1})):(n(),u(o,{key:0,class:"text-right text-muted tw-italic"},{default:t(()=>a[18]||(a[18]=[s("Loading...",-1)]),void 0,!0),_:1,__:[18]}))],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1},8,["title","subtitle","id"])):S("",!0)]),default:t(()=>[e(l(it),{tabs:F},{"tab-0":t(()=>[e(D,{placementId:C[0],localizationId:l(d),alwaysFullWidth:""},null,8,["placementId","localizationId"])]),"tab-1":t(()=>[e(D,{placementId:C[1],localizationId:l(d)},null,8,["placementId","localizationId"])]),_:1}),e(l(lt),{data:i.value,label:"localizationData"},null,8,["data"])]),_:1},8,["variant","is-loading","error","alerts"])}}});export{Pt as default};
