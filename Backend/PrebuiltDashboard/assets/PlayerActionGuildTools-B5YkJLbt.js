import{d as E,E as R,ab as L,h as c,r as N,a as m,m as v,f as t,o as r,j as o,w as s,k as n,T as h,q as a,_ as $,t as u,e as w,ad as j,v as C,F as T,b as V,x as G,ae as I,bs as z}from"./index-DAyiym1a.js";import{a as D}from"./players-CkgXyjra.js";import{_ as F}from"./MetaGeneratedForm.vue_vue_type_script_setup_true_lang-DdaVgxEJ.js";import{_ as Y}from"./MModal.vue_vue_type_script_setup_true_lang-BkBKbY8Q.js";import"./GeneratedUiFormDynamicComponent.vue_vue_type_script_setup_true_lang-BiTvhFwY.js";import"./MInputMultiSelectCheckbox.vue_vue_type_script_setup_true_lang-D6xsoOzq.js";import"./MInputCheckbox.vue_vue_type_script_setup_true_lang-CmGaUCkv.js";import"./MInputHintMessage.vue_vue_type_script_setup_true_lang-B7AbTbVm.js";import"./MInputSingleSelectDropdown.vue_vue_type_script_setup_true_lang-BRIBVSuX.js";import"./index-CVSO09yM.js";const q={key:0},O={class:"!tw-overflow-x-hidden"},U={class:"tw-mb-2 tw-text-sm"},W={class:"tw-mb-2 tw-mt-3"},H={key:0,class:"tw-my-2 tw-flex tw-flex-wrap"},J={key:2,class:"small tw-italic tw-text-neutral-500"},K={class:"tw-end-0 tw-mt-2"},Q={class:"!tw-overflow-x-hidden"},X={class:"tw-mb-2"},Z={class:"tw-mb-2 tw-mt-3"},ee={class:"tw-end-0 tw-mt-2"},te={key:0,class:"tw-justify-center"},se={key:1},le={key:2},ve=E({__name:"PlayerActionGuildTools",props:{playerId:{}},setup(M){const B=M,y=z(),{data:d}=R(D(B.playerId));L();const p=c(),f=c({}),_=c(!1),i=c([]),b=c();async function P(){f.value={},_.value=!1,i.value=[],await x()}async function A(g){i.value=null;const e=await y.post(`/players/${d.value.id}/guildSearch`,f.value);i.value=e.data}async function x(){p.value=null;const g=await y.post(`/players/${d.value.id}/guildRecommendations`);p.value=g.data}return(g,e)=>{const k=N("fa-icon"),S=N("b-spinner");return t(d)?(r(),m("div",q,[o(t(h),{"disabled-tooltip":t(d)?"":"Waiting for player data..",onClick:b.value?.open},{default:s(()=>e[2]||(e[2]=[n("Guild Tools",-1)]),void 0,!0),_:1,__:[2]},8,["disabled-tooltip","onClick"]),o(t(Y),{ref_key:"guildToolsModal",ref:b,title:`Guild Tools for ${t(d).model.playerName||"n/a"}`,onShow:P},{"action-button-icon":s(()=>[o(k,{class:"tw-mr-1 tw-h-4 tw-w-4",icon:"chess-rook"})]),default:s(()=>[a("div",O,[e[6]||(e[6]=a("h6",{class:"tw-mb-1"},"Guild Recommendations",-1)),a("p",U,[e[3]||(e[3]=n("An example list of guilds that could be recommended for ",-1)),o(t($),null,{default:s(()=>[n(u(t(d).model.playerName||"n/a"),1)],void 0,!0),_:1}),e[4]||(e[4]=n(".",-1))]),e[7]||(e[7]=a("p",{class:"tw-text-sm+ tw-text-neutral-500"},"Note: This is not the exact list shown in the game at the moment, but rather an example of what recommendations the current game logic produces.",-1)),a("div",W,[p.value==null?(r(),m("div",H,[o(S,{class:"tw-my-5",label:"Loading..."})])):p.value&&p.value.length>0?(r(),w(t(C),{key:1,showBorder:""},{default:s(()=>[(r(!0),m(T,null,V(p.value,l=>(r(),w(t(G),{class:"tw-px-5",key:l.guildId,striped:""},{"top-right":s(()=>[o(t(I),{to:`/guilds/${l.guildId}`},{default:s(()=>[n(u(l.guildId),1)],void 0,!0),_:2},1032,["to"])]),"bottom-left":s(()=>[a("span",null,u(l.numMembers)+" / "+u(l.maxNumMembers)+" members",1)]),default:s(()=>[a("span",null,u(l.displayName),1)],void 0,!0),_:2},1024))),128))],void 0,!0),_:1})):(r(),m("div",J,"No guilds found. This could be because you have no guilds, or because the guild search failed. You can refresh to try again.")),a("div",K,[o(t(h),{size:"small",onClick:x},{icon:s(()=>[o(k,{class:"tw-mr-1 tw-h-4 tw-w-3",icon:"sync-alt"})]),default:s(()=>[e[5]||(e[5]=n("Refresh",-1))],void 0,!0),_:1,__:[5]})])])])]),"right-panel":s(()=>[a("div",Q,[e[11]||(e[11]=a("h6",{class:"tw-mb-1"},"Guild Search",-1)),a("p",X,[e[8]||(e[8]=n("Perform a guild search as ",-1)),o(t($),null,{default:s(()=>[n(u(t(d).model.playerName||"n/a"),1)],void 0,!0),_:1}),e[9]||(e[9]=n(" would see it.",-1))]),e[12]||(e[12]=a("span",{class:"tw-text-sm+ tw-text-neutral-500"},"You can use this tool to preview how particular players are shown guild search results in the game.",-1)),a("div",Z,[o(F,{modelValue:f.value,"onUpdate:modelValue":e[0]||(e[0]=l=>f.value=l),typeName:"Metaplay.Core.Guild.GuildSearchParamsBase","logic-version":t(d).model.logicVersion,onStatus:e[1]||(e[1]=l=>_.value=l)},null,8,["modelValue","logic-version"]),a("div",ee,[o(t(h),{"disabled-tooltip":_.value?void 0:"Please complete the search form before searching.",size:"small",onClick:A},{default:s(()=>e[10]||(e[10]=[n("Search",-1)]),void 0,!0),_:1,__:[10]},8,["disabled-tooltip"])]),i.value==null?(r(),m("div",te,[o(S,{class:"tw-my-5",label:"Loading..."})])):v("",!0),i.value!==null&&i.value.isError===!0?(r(),m("p",se,"Search failed")):v("",!0),i.value!==null&&i.value.isError===!1?(r(),m("div",le,[a("p",null,u(t(j)(i.value.guildInfos.length,"result",!0))+".",1),i.value.guildInfos&&i.value.guildInfos.length>0?(r(),w(t(C),{key:0,showBorder:""},{default:s(()=>[(r(!0),m(T,null,V(i.value.guildInfos,l=>(r(),w(t(G),{class:"tw-px-5",key:l.guildId,striped:""},{"top-right":s(()=>[o(t(I),{to:`/guilds/${l.guildId}`},{default:s(()=>[n(u(l.guildId),1)],void 0,!0),_:2},1032,["to"])]),"bottom-left":s(()=>[a("span",null,u(l.numMembers)+" / "+u(l.maxNumMembers)+" members",1)]),default:s(()=>[a("span",null,u(l.displayName),1)],void 0,!0),_:2},1024))),128))],void 0,!0),_:1})):v("",!0)])):v("",!0)])])]),_:1},8,["title"])])):v("",!0)}}});export{ve as default};
