import{d as L,c as r,r as S,e as y,o as u,w as i,j as d,f as a,x as T,k as c,t as p,ae as f,q as D,m as b,y as k,D as M}from"./index-DAyiym1a.js";import{M as s,a as o,b as N}from"./metaListUtils-B-xQ0HnD.js";const $={class:"tw-text-red-500"},A=1,V=L({__name:"IncidentHistoryCard",props:{incidents:{},playerName:{},isLimitedTo:{},showMainPageLink:{type:Boolean},showDescription:{type:Boolean}},setup(_){const n=_,h=["type","reason","incidentId"],w=[new s("Time","uploadedAt",o.Ascending),new s("Time","uploadedAt",o.Descending),new s("Type","type",o.Ascending),new s("Type","type",o.Descending)],v=r(()=>[N.asDynamicFilterSet(n.incidents??[],"type",e=>e.type)]),m=r(()=>n.playerName===void 0),g=r(()=>{if(n.showDescription)return"Incidents are reports of situations where a player may have had the game crash or freeze. They should be investigated and fixed!";{let e="";return n.isLimitedTo?e+=`The ${n.isLimitedTo} most recent`:e+="Recent",e+=" incidents (crashes, network errors, etc.) that have happened to ",m.value?e+="any player.":e+=`${n.playerName}.`,e}});return(e,l)=>{const I=S("meta-list-card");return u(),y(I,{title:"Recent Incident History",icon:"ambulance",dangerous:"",itemList:e.incidents,allowPausing:"",searchFields:h,filterSets:v.value,sortOptions:w,defaultSortOption:A,emptyMessage:"No incidents reported.",moreInfoUri:e.showMainPageLink?"/playerIncidents":void 0,moreInfoLabel:e.showMainPageLink?"player incidents":void 0,permission:"api.incident_reports.view",description:g.value},{"item-card":i(t=>[d(a(T),null,{"top-right":i(()=>[d(a(k),{instant:a(M).fromISO(t.item.uploadedAt)},null,8,["instant"])]),"bottom-left":i(()=>[D("div",$,p(t.item.reason),1),m.value?(u(),y(a(f),{key:0,permission:"api.players.view",to:`/players/${t.item.playerId}`},{default:i(()=>[c(p(t.item.playerId),1)],void 0,!0),_:2},1032,["to"])):b("",!0)]),"bottom-right":i(()=>[d(a(f),{permission:"api.incident_reports.view",to:`/players/${t.item.playerId}/${t.item.incidentId}`},{default:i(()=>l[0]||(l[0]=[c("View incident",-1)]),void 0,!0),_:2,__:[0]},1032,["to"])]),default:i(()=>[c(p(t.item.type),1)],void 0,!0),_:2},1024)]),_:1},8,["itemList","filterSets","moreInfoUri","moreInfoLabel","description"])}}});export{V as _};
