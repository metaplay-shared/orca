import{d as X,aj as $,h,c as w,aP as F,K as L,ak as G,aQ as Y,aR as _,a as i,o as r,m as c,q as o,j as ee,e as te,Q as b,f as S,t as V,aS as le,aT as ae,aU as C,aV as y,a7 as P,k as H,n as x,w as ne,F as se,b as oe,aW as re,aX as ie,al as de}from"./index-DAyiym1a.js";import{_ as ue}from"./MInputHintMessage.vue_vue_type_script_setup_true_lang-B7AbTbVm.js";const we=["data-testid"],ve=["for"],ce=["id","placeholder","disabled","onKeydown","data-testid"],pe=["data-testid"],ge={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"tw-pointer-events-none tw-w-5 tw-h-5","aria-hidden":"true"},fe={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"tw-pointer-events-none tw-w-5 tw-h-5","aria-hidden":"true"},be={key:2,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"tw-pointer-events-none tw-w-5 tw-h-5","aria-hidden":"true"},me=["data-testid"],he=["data-testid"],Ve=["disabled","onClick","onMouseenter","data-testid"],ye={class:"tw-flex tw-justify-between"},xe={class:"tw-grow tw-overflow-hidden tw-text-ellipsis"},Ce={key:0,class:"tw-ml-2 tw-select-none"},Me=X({__name:"MInputSingleSelectDropdown",props:{modelValue:{},options:{},searchFunction:{type:Function,default:void 0},label:{default:void 0},disabled:{type:Boolean,default:!1},variant:{default:"neutral"},hintMessage:{default:void 0},placeholder:{default:"Select option"},emptyMessage:{default:"No results found"},dataTestid:{default:void 0},minHeight:{default:void 0}},emits:["update:modelValue"],setup(N,{emit:R}){const n=N,k=R,O=$("input-single-select-dropdown"),j=h(),M=h(),p=h(),g=w(()=>n.options.find(e=>"clearedValue"in e)),T=w(()=>n.options.filter(e=>!("clearedValue"in e))),d=w(()=>{const e=n.options.find(t=>{const l="value"in t?t.value:t.clearedValue;return F(l,n.modelValue)});if(e)return e;if(n.modelValue){let t;if(typeof n.modelValue=="object")if("name"in n.modelValue&&typeof n.modelValue.name=="string")t=n.modelValue.name;else if("id"in n.modelValue&&typeof n.modelValue.id<"u")t=`Object ${n.modelValue.id}`;else try{t=JSON.stringify(n.modelValue)}catch{t="[Object]"}else t=String(n.modelValue);return{label:t,value:n.modelValue}}else return}),u=h(""),v=h(0),m=w(()=>u.value?(n.searchFunction??E)(T.value,u.value):T.value);function E(e,t){const l=t.toLowerCase();return e.filter(a=>a.label.toLowerCase().includes(l))}function z(e){if(!s.value.open){s.value.setOpen(!0);return}const t=m.value;if(!t.length)return;const l=t.length-1;let a=v.value;a<0||a>=t.length?a=e==="next"?0:l:(a=e==="next"?a+1:a-1,a<0&&(a=l),a>l&&(a=0));let f=0;const I=t.length;for(;f<I&&t[a].disabled;)if(a=e==="next"?a+1:a-1,a<0&&(a=l),a>l&&(a=0),f++,f>=I)return;v.value=a,D()}function K(){z("next")}function q(){z("previous")}function D(){ie(()=>{if(!p.value)return;const e=p.value.children[v.value];if(e){const t=p.value.getBoundingClientRect(),l=e.getBoundingClientRect();l.bottom>t.bottom?p.value.scrollTop+=l.bottom-t.bottom:l.top<t.top&&(p.value.scrollTop-=t.top-l.top)}})}function Q(){if(!s.value.open)return;const e=m.value[v.value];e&&!e.disabled&&B(e)}function B(e){e.disabled||(k("update:modelValue",e.value),s.value.setOpen(!1),M.value?.focus())}function U(e){n.disabled||!g.value||(k("update:modelValue",g.value.clearedValue),s.value.setOpen(!1))}L(()=>n.modelValue,e=>{u.value=""},{immediate:!0}),L(u,e=>{e.length>0&&!s.value.open&&s.value.setOpen(!0)});const Z=G(Y,{id:$("input-single-select-dropdown"),modal:!1,autoFocus:!1,closeOnEscape:!0,portalled:!0,positioning:{offset:{mainAxis:1},sameWidth:!0},onOpenChange:e=>{if(e.open){const t=m.value.findIndex(l=>F(l.value,n.modelValue));v.value=t>=0?t:0}else u.value=""}}),s=w(()=>_(Z,de)),A=w(()=>{const e=n.options.some(a=>"value"in a?a.value===n.modelValue:!1),t=!n.modelValue;let l;if(g.value?l=g.value.clearedValue===n.modelValue||t&&!e:l=t&&!e,!s.value.open&&l)return n.placeholder}),W=w(()=>{switch(n.variant){case"success":return"tw-border-green-500 tw-ring-green-500";case"danger":return"tw-border-red-500 tw-ring-red-500";case"warning":return"tw-border-orange-500 tw-ring-orange-500";default:return"tw-border-neutral-300 tw-ring-neutral-300"}}),J=w(()=>{switch(n.variant){case"success":return"tw-bg-green-500 hover:tw-bg-green-600 active:tw-bg-green-700";case"danger":return"tw-bg-red-500 hover:tw-bg-red-600 active:tw-bg-red-700";case"warning":return"tw-bg-orange-500 hover:tw-bg-orange-600 active:tw-bg-orange-700";default:return""}});return(e,t)=>(r(),i("div",{class:"tw-space-y-1","data-testid":`${e.dataTestid}-root`},[e.label?(r(),i("label",{key:0,for:S(O),class:b(["tw-block tw-text-sm tw-font-bold tw-leading-6",{"tw-text-neutral-400":e.disabled,"tw-text-neutral-900":!e.disabled}])},V(e.label),11,ve)):c("",!0),o("div",x(s.value.getTriggerProps(),{class:"tw-relative tw-isolate tw-flex tw-min-h-9 tw-w-full tw-items-center tw-rounded-md tw-border tw-text-sm tw-text-neutral-900 tw-shadow-sm placeholder:tw-text-neutral-400 focus:tw-ring-2 focus:tw-ring-inset focus:tw-ring-blue-600"},{ref_key:"triggerElement",ref:j,class:[{"tw-rounded-b-none":s.value.open,"tw-bg-neutral-100 tw-cursor-not-allowed tw-select-none":e.disabled,"tw-bg-white":!e.disabled},W.value],style:{minHeight:e.minHeight}}),[le(o("input",{class:b(["tw-absolute tw-inset-0 tw-z-10 tw-grow tw-rounded-md tw-border-none tw-bg-transparent tw-text-sm tw-ring-inset focus:tw-ring-2 focus:tw-ring-blue-600 disabled:tw-cursor-not-allowed disabled:tw-text-neutral-500",{"tw-rounded-b-none":s.value.open,"tw-caret-transparent":!s.value.open}]),ref_key:"inputRef",ref:M,"onUpdate:modelValue":t[0]||(t[0]=l=>u.value=l),id:S(O),placeholder:A.value,disabled:e.disabled,onKeydown:[C(y(K,["prevent"]),["down"]),C(y(q,["prevent"]),["up"]),C(y(Q,["prevent"]),["enter"])],"data-testid":e.dataTestid},null,42,ce),[[ae,u.value]]),o("div",{class:b(["tw-flex-grow tw-overflow-hidden tw-text-ellipsis tw-py-1 tw-pl-3 tw-pr-2",{"tw-text-neutral-500":e.disabled}]),"data-testid":d.value?`${e.dataTestid}-selected-option`:void 0},[u.value.length===0&&d.value&&"label"in d.value&&!s.value.open?P(e.$slots,"option",{key:0,option:{label:d.value.label,value:d.value.value,disabled:d.value.disabled}},()=>[H(V(d.value.label),1)]):c("",!0)],10,pe),o("div",{class:b(["tw-z-10 tw-flex tw-select-none tw-items-center tw-space-x-1",{"tw-pointer-events-none":e.disabled}])},[e.variant==="success"?(r(),i("svg",ge,t[2]||(t[2]=[o("path",{class:"tw-text-neutral-50",d:"M3 10 a7 7 0 1 1 14 0 a7 7 0 1 1 -14 0 Z"},null,-1),o("path",{class:"tw-text-green-500","fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z","clip-rule":"evenodd"},null,-1)]))):c("",!0),e.variant==="warning"?(r(),i("svg",fe,t[3]||(t[3]=[o("path",{class:"tw-text-orange-500","fill-rule":"evenodd",d:"M10 2L2 18h16L10 2z","clip-rule":"evenodd"},null,-1),o("path",{class:"tw-text-orange-50","fill-rule":"evenodd",d:"M9 6h2v6H9V6zm0 8h2v2H9v-2z","clip-rule":"evenodd"},null,-1)]))):e.variant==="danger"?(r(),i("svg",be,t[4]||(t[4]=[o("path",{class:"tw-text-neutral-50",d:"M3 10 a7 7 0 1 1 14 0 a7 7 0 1 1 -14 0 Z"},null,-1),o("path",{class:"tw-text-red-500","fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z","clip-rule":"evenodd"},null,-1)]))):c("",!0),g.value&&d.value!==g.value&&!e.disabled?(r(),i("button",{key:3,onClick:y(U,["stop"]),"data-testid":`${e.dataTestid}-clear-button`},[(r(),i("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",class:b(["tw-size-4 tw-fill-neutral-50 tw-p-0.5 tw-rounded-full tw-bg-neutral-400 hover:tw-bg-neutral-500 active:tw-bg-neutral-600 tw-cursor-pointer",J.value])},t[5]||(t[5]=[o("path",{d:"M5.28 4.22a.75.75 0 0 0-1.06 1.06L6.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L8 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L9.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L8 6.94 5.28 4.22Z"},null,-1)]),2))],8,me)):c("",!0),t[6]||(t[6]=o("div",{class:"tw-cursor-pointer tw-pr-3 tw-text-neutral-400 hover:tw-text-neutral-500 active:tw-text-neutral-600"},"▼",-1))],2)],16),ee(ue,{variant:e.variant},{default:ne(()=>[H(V(e.hintMessage),1)],void 0,!0),_:1},8,["variant"]),(r(),te(re,{to:"body"},[o("div",x(s.value.getPositionerProps(),{style:{zIndex:9999}}),[o("ul",x(s.value.getContentProps(),{class:"tw-max-h-80 tw-overflow-y-auto tw-overflow-x-hidden tw-overflow-ellipsis tw-rounded-b-md tw-border tw-border-neutral-300 tw-bg-white tw-text-sm tw-shadow-md"},{ref_key:"listbox",ref:p,onMousedown:t[1]||(t[1]=y(()=>{},["prevent"])),"data-testid":`${e.dataTestid}-dropdown`}),[(r(!0),i(se,null,oe(m.value,(l,a)=>(r(),i("li",{key:l.label,disabled:l.disabled,class:b(["tw-px-3 tw-py-1.5 last:tw-rounded-b-md",{"!tw-bg-blue-500 hover:!tw-bg-blue-600 !tw-text-white":e.modelValue===l.value,"tw-bg-neutral-200":v.value===a&&e.modelValue!==l.value,"tw-text-neutral-400 tw-bg-neutral-100 tw-cursor-not-allowed tw-italic":l.disabled,"tw-cursor-pointer":!l.disabled}]),onClick:f=>B(l),onMouseenter:f=>v.value=a,"data-testid":`${e.dataTestid}-option-${l.label}`},[P(e.$slots,"option",{option:{label:l.label,value:l.value,disabled:l.disabled}},()=>[o("div",ye,[o("div",xe,V(l.label),1),e.modelValue===l.value?(r(),i("span",Ce,"✓")):c("",!0)])])],42,Ve))),128)),m.value.length===0?(r(),i("li",x({key:0},s.value.getContentProps(),{class:"tw-select-none tw-bg-neutral-200 tw-px-3 tw-py-1 tw-text-sm tw-italic tw-text-neutral-500"}),V(e.emptyMessage),17)):c("",!0)],16,he)],16)]))],8,we))}});export{Me as _};
