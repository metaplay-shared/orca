import{d as y,E as h,h as l,K as w,c as S,e as _,o as A,w as V,q as r,j as k,t as D,f as o,bs as $,bt as x}from"./index-DAyiym1a.js";import{m as C}from"./actionDebouncer-D31HA7Ay.js";import{m as E}from"./axiosActionHandler-C84uzh5g.js";import{a as P}from"./players-CkgXyjra.js";import{_ as B}from"./MInputText.vue_vue_type_script_setup_true_lang-B9sf9LSD.js";import{_ as I}from"./MActionModalButton.vue_vue_type_script_setup_true_lang-CRnsCPt_.js";import"./MInputHintMessage.vue_vue_type_script_setup_true_lang-B7AbTbVm.js";import"./debounce-CRuraxcR.js";import"./isSymbol-BXvDeGRF.js";import"./MActionModal.vue_vue_type_script_setup_true_lang-XDUxofmt.js";import"./index-CVSO09yM.js";const T={class:"tw-mb-4"},z=y({__name:"PlayerActionEditName",props:{playerId:{}},setup(s){const d=s,m=$(),{data:t,refresh:u}=h(P(d.playerId)),a=l(""),i=l("valid");function p(){a.value=t.value?.model.playerName??""}function c(e){return e==="no-change"?"Change the name to proceed.":e==="validating"?"Validating name...":e==="invalid"?"The chosen name is not valid. Fill in a valid name to proceed.":void 0}const v=C(E(),e=>{e.data.nameWasValid?a.value===t.value?.model.playerName?i.value="no-change":i.value="valid":i.value="invalid"},()=>{},500);w(a,()=>{a.value===t.value?.model.playerName?i.value="no-change":i.value="validating",v.requestAction({url:`/players/${t.value.id}/validateName`,method:"post",data:{newName:a.value}})});const f=S(()=>({valid:"success",invalid:"danger","no-change":"default",validating:"loading"})[i.value]??"danger"),{showSuccessNotification:g}=x();async function N(){try{await m.post(`/players/${t.value.id}/changeName`,{NewName:a.value});const e=`Player '${t.value.id}' is now '${a.value}'.`;g(e)}finally{u()}}return(e,n)=>(A(),_(o(I),{"trigger-button-disabled-tooltip":o(t)?"":"Waiting for player data..","modal-title":"Edit Player Name",action:N,"trigger-button-label":"Edit Name",variant:"warning","ok-button-disabled-tooltip":c(i.value),"confirm-permission":"api.players.edit_name",onShow:p,"data-testid":"action-edit-name"},{default:V(()=>[n[1]||(n[1]=r("h6",{class:"tw-mb-1 tw-font-semibold"},"Current Name",-1)),r("p",T,D(o(t).model.playerName??"n/a"),1),k(o(B),{label:"New Name","model-value":a.value,variant:f.value,"hint-message":"Same rules are applied to name validation as changing it in-game.",placeholder:"DarkAngel87","onUpdate:modelValue":n[0]||(n[0]=b=>a.value=b),"data-testid":"name-input"},null,8,["model-value","variant"])]),_:1},8,["trigger-button-disabled-tooltip","ok-button-disabled-tooltip"]))}});export{z as default};
