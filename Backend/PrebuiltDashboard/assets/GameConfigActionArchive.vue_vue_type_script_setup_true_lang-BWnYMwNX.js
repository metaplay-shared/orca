import{d as G,h as C,E as N,c9 as x,c as _,r as H,a as c,o,e as h,j as d,f as t,bE as z,w as l,q as n,T as I,k as s,t as v,_ as w,m as M,ad as k,F as U,bs as B,bt as O}from"./index-DAyiym1a.js";import{_ as T}from"./MInputCheckbox.vue_vue_type_script_setup_true_lang-CmGaUCkv.js";import{_ as E}from"./MInputHintMessage.vue_vue_type_script_setup_true_lang-B7AbTbVm.js";import{_ as D}from"./MActionModal.vue_vue_type_script_setup_true_lang-XDUxofmt.js";const F={key:1,class:"tw-inline-flex tw-h-4 tw-w-5",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 640 512"},P={class:"tw-space-y-4"},Y={key:0},j={key:1},q={key:0,class:"tw-mt-3"},L={class:"tw-font-semibold"},Q=G({__name:"GameConfigActionArchive",props:{gameConfigId:{},triggerStyle:{}},setup(y){const p=B(),g=y,m=C(!1),f=C(),{data:u,refresh:V}=N(x()),i=_(()=>{if(u.value)return u.value.find(a=>a.id===g.gameConfigId)}),r=_(()=>{const a=u.value?.find(e=>e.id===g.gameConfigId);return a?(u.value??[]).filter(e=>!e.isArchived&&!(e.publishedAt!==null||e.unpublishedAt!==null||e.isActive)&&e.buildStartedAt<a.buildStartedAt).map(e=>e.id):[]}),{showSuccessNotification:A}=O();async function S(){const a={isArchived:!i.value?.isArchived};await p.post(`/gameConfig/${g.gameConfigId}`,a),m.value&&r.value.length>0?(await p.post("/gameConfig/archive",r.value),A(`Archived ${r.value.length+1} game configs.`)):A(`Game config ${a.isArchived?"archived":"unarchived"}.`),V()}return(a,e)=>{const $=H("fa-icon");return o(),c(U,null,[a.triggerStyle==="icon"?(o(),h(t(z),{key:0,permission:"api.game_config.edit","aria-label":i.value?.isArchived?"Unarchive this game config":"Archive this game config.","disabled-tooltip":i.value?.isActive?"Cannot archive the active game config.":void 0,onClick:f.value?.open,"data-testid":"`archive-config-${gameConfigId}`"},{default:l(()=>[i.value?.isArchived?(o(),c("svg",F,e[2]||(e[2]=[n("path",{d:"M256 48c0-26.5 21.5-48 48-48H592c26.5 0 48 21.5 48 48V464c0 26.5-21.5 48-48 48H381.3c1.8-5 2.7-10.4 2.7-16V253.3c18.6-6.6 32-24.4 32-45.3V176c0-26.5-21.5-48-48-48H256V48zM571.3 347.3c6.2-6.2 6.2-16.4 0-22.6l-64-64c-6.2-6.2-16.4-6.2-22.6 0l-64 64c-6.2 6.2-6.2 16.4 0 22.6s16.4 6.2 22.6 0L480 310.6V432c0 8.8 7.2 16 16 16s16-7.2 16-16V310.6l36.7 36.7c6.2 6.2 16.4 6.2 22.6 0zM0 176c0-8.8 7.2-16 16-16H368c8.8 0 16 7.2 16 16v32c0 8.8-7.2 16-16 16H16c-8.8 0-16-7.2-16-16V176zm352 80V480c0 17.7-14.3 32-32 32H64c-17.7 0-32-14.3-32-32V256H352zM144 320c-8.8 0-16 7.2-16 16s7.2 16 16 16h96c8.8 0 16-7.2 16-16s-7.2-16-16-16H144z"},null,-1)]))):(o(),h($,{key:0,class:"tw-size-3.5",icon:"box-archive"}))],void 0,!0),_:1},8,["aria-label","disabled-tooltip","onClick"])):(o(),h(t(I),{key:1,permission:"api.game_config.edit","disabled-tooltip":i.value?.isActive?"Cannot archive the active game config.":void 0,"full-width":"",onClick:e[0]||(e[0]=b=>f.value?.open())},{default:l(()=>[s(v(i.value?.isArchived?"Unarchive":"Archive"),1)],void 0,!0),_:1},8,["disabled-tooltip"])),d(t(D),{ref_key:"gameConfigArchiveModal",ref:f,title:i.value?.isArchived?"Unarchive Game Config":"Archive Game Config",action:S,"ok-button-label":i.value?.isArchived?"Unarchive":"Archive","data-testid":"`archive-config-${gameConfigId}`",confirmPermission:"api.game_config.edit"},{default:l(()=>[n("div",P,[i.value?.isArchived?(o(),c("div",Y,[n("p",null,[e[3]||(e[3]=s("You are about to unarchive the game config ",-1)),d(t(w),null,{default:l(()=>[s(v(i.value?.name||"No Name Available"),1)],void 0,!0),_:1}),e[4]||(e[4]=s(".",-1))]),e[5]||(e[5]=n("p",{class:"tw-mt-1 tw-text-xs+ tw-text-neutral-500"},"This will make the game config visible in the list of available game configs again.",-1))])):(o(),c("div",j,[n("p",null,[e[6]||(e[6]=s("You are about to archive the game config ",-1)),d(t(w),null,{default:l(()=>[s(v(i.value?.name||"No Name Available"),1)],void 0,!0),_:1}),e[7]||(e[7]=s(".",-1))]),e[8]||(e[8]=n("p",{class:"tw-mt-1 tw-text-xs+ tw-text-neutral-500"},"Archiving a game config will hide it from the list of available game configs. An archived game config can be unarchived at any time.",-1)),r.value?.length>0?(o(),c("div",q,[d(t(T),{"model-value":m.value,size:"small","onUpdate:modelValue":e[1]||(e[1]=b=>m.value=b)},{default:l(()=>[n("span",L,"Also Archive "+v(t(k)(r.value?.length,"Older, Unpublished Config",!0)),1)],void 0,!0),_:1},8,["model-value"]),d(t(E),null,{default:l(()=>[s("At the same time as archiving this game config, you can also archive "+v(t(k)(r.value?.length,"older, unpublished config",!0))+". This is useful in keeping your game config history manageable.",1)],void 0,!0),_:1})])):M("",!0)])),e[9]||(e[9]=n("p",null,"All good?",-1))])],void 0,!0),_:1},8,["title","ok-button-label"])],64)}}});export{Q as _};
